<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Waterfall</title>
    <script>

        var imgNumber = 31;
        var imgFileSuffix = ".jpg";

        var windowWidth;
        var imgColNumber;

        var imgWidth = 230;
        var imgPadding = 0;
        var imgMargin = 5;
        var imgBoxWidth = imgWidth + 2 * imgPadding + 2 * imgMargin;
        var imgBorder = "0.5px lightgray solid";
        var imgPosition = "absolute";


        function initImg() {

            for (var i = 1; i <= imgNumber; i++) {

                //get src
                var srcStr = "./img/"+padStart(i.toString(), 3, "0") + imgFileSuffix;
                //create <img>
                var oImg = document.createElement("img");
                //set src
                oImg.src = srcStr;

                //set constant css style
                oImg.style.width = imgWidth + "px";
                oImg.style.padding = imgPadding + "px";
                oImg.style.margin = imgMargin + "px";
                oImg.style.border = imgBorder;
                oImg.style.position = imgPosition;
                oImg.style.display="none";

                //add <img> to body
                document.body.appendChild(oImg);

            }
        }

        function updatePosition() {

            //get the number of img for each row

            windowWidth = document.documentElement.clientWidth;
            imgColNumber = Math.floor(windowWidth / (imgBoxWidth));
            console.log("-------------------Column number:" +imgColNumber+"-------------------");

            //generate empty img for the first row
            var imgBtmArr = new Array();
            for (var i = 0; i < imgColNumber; i++) {
                imgBtmArr.push({left: i * imgBoxWidth, top: 0});
            }
            console.log("First row: ");
            console.log(imgBtmArr);

            var oImgArr = document.body.getElementsByTagName("img");


            for (var i = 0; i < oImgArr.length; i++) {
                var oImg = oImgArr[i];
                oImg.style.display="block";


                /*
                set dynamic css style:left and top
                and update bottom img position
                */

                //looking for the highest column
                var minCol = 0;
                for (var j = 1; j < imgBtmArr.length; j++) {
                    if (imgBtmArr[j].top < imgBtmArr[minCol].top) {
                        minCol = j;
                    }
                }
                oImg.style.left = imgBtmArr[minCol].left + "px";
                oImg.style.top = imgBtmArr[minCol].top + "px";
                //update bottom row image position
                imgBtmArr[minCol].top += oImg.height+2*imgPadding+imgMargin;

                //log
                console.log("img:"+oImg.src+" position: col:" + minCol + " top:" + imgBtmArr[minCol].top+"px");
            }
        }


        window.onload = function () {
            initImg();
            setTimeout(updatePosition,100);

        };
        window.onresize = function () {
            updatePosition();

        };


        function padStart(str, maxLen, ch) {

            var len = str.length;
            for (var i = 0; i < maxLen - len; i++) {
                str = ch + str;
            }
            return str;
        }
    </script>
</head>
<body>


</body>
</html>